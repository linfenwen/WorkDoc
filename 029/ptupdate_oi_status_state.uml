@startuml

[*] --> OI_STATUS_NOTSTARTED

OI_STATUS_NOTSTARTED --> OI_STATUS_DOWNLOAD_SETTING : GetSiteSettingByXML

OI_STATUS_DOWNLOAD_SETTING -->  OI_STATUS_NEED_VERSIONFILE : OnGetSiteSetting
OI_STATUS_NEED_VERSIONFILE --> OI_STATUS_DOWNLOAD_VERSIONFILE : GetVersionFileFromSite
note right of OI_STATUS_NEED_VERSIONFILE : use ptWBXOIURL (InternetConnect) to get file \ncall URLReturn to return data

OI_STATUS_DOWNLOAD_VERSIONFILE -right-> OI_STATUS_NEED_INIFILE : OnGetVersionFile
OI_STATUS_NEED_INIFILE -up-> OI_STATUS_DOWNLOAD_INIFILE : GetINIFileFromSite
OI_STATUS_DOWNLOAD_INIFILE -up-> OI_STATUS_CHECK_INIFILE : OnGetINIFile
OI_STATUS_CHECK_INIFILE -up-> OI_STATUS_END : OnCheckINIFile
note left of OI_STATUS_END : set m_bQuit = TRUE
OI_STATUS_END -up-> OI_STATUS_IDLE : OnTimer
OI_STATUS_IDLE -up-> [*] : OnTimer

@enduml